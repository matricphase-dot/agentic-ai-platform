<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Agentic AI</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .settings-section {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #475569;
            transition: .4s;
            border-radius: 34px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #6366f1;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
        }
        .form-input {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: white;
        }
        .form-select {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: white;
        }
        .danger-zone {
            border: 2px solid rgba(239, 68, 68, 0.3);
            background: rgba(239, 68, 68, 0.1);
        }
        .save-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
            <div class="nav-links">
                <a href="/" class="nav-link"><i class="fas fa-arrow-left"></i> Dashboard</a>
                <a href="/profile" class="nav-link"><i class="fas fa-user"></i> Profile</a>
                <a href="/help" class="nav-link"><i class="fas fa-question-circle"></i> Help</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="dashboard-header">
            <h1><i class="fas fa-sliders-h"></i> Platform Settings</h1>
            <p class="subtitle">Configure your Agentic AI experience • All settings are applied immediately</p>
        </div>

        <!-- Quick Settings Toggles -->
        <div class="settings-section">
            <h2><i class="fas fa-toggle-on"></i> Quick Settings</h2>
            <div class="settings-grid">
                <div class="setting-item">
                    <div>
                        <strong>Auto-start on Boot</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Start Agentic AI when computer starts</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoStart" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Hotkeys Enabled</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Enable F10, F9 hotkeys for recording</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="hotkeysEnabled" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>AI Suggestions</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Show AI-powered suggestions</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="aiSuggestions" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Auto-update</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Automatically update platform</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoUpdate" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <!-- AI Configuration -->
        <div class="settings-section">
            <h2><i class="fas fa-brain"></i> AI Configuration</h2>
            <div class="form-group">
                <label class="form-label">Default AI Model</label>
                <select class="form-select" id="aiModel">
                    <option value="llama3.2">Llama 3.2 (Recommended)</option>
                    <option value="llama3.2-3b">Llama 3.2 3B (Faster)</option>
                    <option value="mistral">Mistral</option>
                    <option value="custom">Custom Model</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">Ollama Host</label>
                <input type="text" class="form-input" id="ollamaHost" value="http://localhost:11434" placeholder="Ollama server URL">
            </div>
            
            <div class="form-group">
                <label class="form-label">AI Temperature</label>
                <input type="range" class="form-input" id="aiTemperature" min="0" max="1" step="0.1" value="0.7">
                <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                    <span style="color: #94a3b8;">More Focused</span>
                    <span style="color: #94a3b8;" id="temperatureValue">0.7</span>
                    <span style="color: #94a3b8;">More Creative</span>
                </div>
            </div>
            
            <div class="setting-item">
                <div>
                    <strong>Use Cloud AI</strong>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Use cloud AI when local is unavailable</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="useCloudAI">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>

        <!-- File Management -->
        <div class="settings-section">
            <h2><i class="fas fa-folder"></i> File Management</h2>
            <div class="form-group">
                <label class="form-label">Default Download Folder</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" class="form-input" id="downloadFolder" value="/Users/AgenticAI/Downloads" readonly>
                    <button class="btn" onclick="selectFolder('download')">
                        <i class="fas fa-folder-open"></i> Browse
                    </button>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Recordings Folder</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" class="form-input" id="recordingsFolder" value="/Users/AgenticAI/Recordings" readonly>
                    <button class="btn" onclick="selectFolder('recordings')">
                        <i class="fas fa-folder-open"></i> Browse
                    </button>
                </div>
            </div>
            
            <div class="setting-item">
                <div>
                    <strong>Auto-organize New Files</strong>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Automatically organize newly downloaded files</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="autoOrganize" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="setting-item">
                <div>
                    <strong>Keep File Backups</strong>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Keep backup copies of modified files</div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="keepBackups" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Desktop Recorder Settings -->
            <div class="settings-section">
                <h2><i class="fas fa-video"></i> Desktop Recorder</h2>
                <div class="form-group">
                    <label class="form-label">Default Recording Quality</label>
                    <select class="form-select" id="recordingQuality">
                        <option value="high">High (1080p)</option>
                        <option value="medium" selected>Medium (720p)</option>
                        <option value="low">Low (480p)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Frame Rate</label>
                    <select class="form-select" id="frameRate">
                        <option value="60">60 FPS</option>
                        <option value="30" selected>30 FPS</option>
                        <option value="24">24 FPS</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Recording Format</label>
                    <select class="form-select" id="recordingFormat">
                        <option value="mp4" selected>MP4</option>
                        <option value="webm">WebM</option>
                        <option value="avi">AVI</option>
                    </select>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Record System Audio</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Include system audio in recordings</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="recordSystemAudio" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Record Microphone</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Include microphone audio in recordings</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="recordMicrophone">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Hotkey Configuration -->
            <div class="settings-section">
                <h2><i class="fas fa-keyboard"></i> Hotkey Configuration</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <div>
                            <strong>Start/Stop Recording</strong>
                            <div style="color: #94a3b8; font-size: 0.9rem;">Main recording hotkey</div>
                        </div>
                        <input type="text" class="form-input" id="hotkeyRecord" value="F10" style="width: 80px; text-align: center;" readonly>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <strong>Take Screenshot</strong>
                            <div style="color: #94a3b8; font-size: 0.9rem;">Capture screenshot hotkey</div>
                        </div>
                        <input type="text" class="form-input" id="hotkeyScreenshot" value="F9" style="width: 80px; text-align: center;" readonly>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <strong>Toggle Recording</strong>
                            <div style="color: #94a3b8; font-size: 0.9rem;">Alternative recording hotkey</div>
                        </div>
                        <input type="text" class="form-input" id="hotkeyToggle" value="Ctrl+Shift+R" style="width: 120px; text-align: center;" readonly>
                    </div>
                    
                    <div class="setting-item">
                        <div>
                            <strong>Quick Screenshot</strong>
                            <div style="color: #94a3b8; font-size: 0.9rem;">Alternative screenshot hotkey</div>
                        </div>
                        <input type="text" class="form-input" id="hotkeyQuick" value="Ctrl+Shift+S" style="width: 120px; text-align: center;" readonly>
                    </div>
                </div>
                
                <button class="btn" onclick="configureHotkeys()" style="margin-top: 15px;">
                    <i class="fas fa-keyboard"></i> Configure Hotkeys
                </button>
            </div>

            <!-- Danger Zone -->
            <div class="settings-section danger-zone">
                <h2><i class="fas fa-exclamation-triangle"></i> Danger Zone</h2>
                <div class="setting-item">
                    <div>
                        <strong>Reset All Settings</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Restore all settings to defaults</div>
                    </div>
                    <button class="btn" style="background: #ef4444;" onclick="resetSettings()">
                        <i class="fas fa-redo"></i> Reset Settings
                    </button>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Clear All Data</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Delete all files, recordings, and automations</div>
                    </div>
                    <button class="btn" style="background: #ef4444;" onclick="clearData()">
                        <i class="fas fa-trash"></i> Clear All Data
                    </button>
                </div>
                
                <div class="setting-item">
                    <div>
                        <strong>Uninstall Agentic AI</strong>
                        <div style="color: #94a3b8; font-size: 0.9rem;">Remove Agentic AI from your system</div>
                    </div>
                    <button class="btn" style="background: #ef4444;" onclick="uninstall()">
                        <i class="fas fa-trash-alt"></i> Uninstall
                    </button>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div class="save-button">
            <button class="btn" style="padding: 15px 30px; font-size: 1.1rem;" onclick="saveSettings()">
                <i class="fas fa-save"></i> Save All Settings
            </button>
        </div>

        <script>
            // Temperature slider
            const tempSlider = document.getElementById('aiTemperature');
            const tempValue = document.getElementById('temperatureValue');
            
            tempSlider.addEventListener('input', function() {
                tempValue.textContent = this.value;
            });
            
            // Load current settings
            function loadSettings() {
                fetch('/api/settings')
                    .then(response => response.json())
                    .then(data => {
                        if (data.autoStart !== undefined) document.getElementById('autoStart').checked = data.autoStart;
                        if (data.hotkeysEnabled !== undefined) document.getElementById('hotkeysEnabled').checked = data.hotkeysEnabled;
                        if (data.aiModel) document.getElementById('aiModel').value = data.aiModel;
                        if (data.ollamaHost) document.getElementById('ollamaHost').value = data.ollamaHost;
                        if (data.aiTemperature !== undefined) {
                            document.getElementById('aiTemperature').value = data.aiTemperature;
                            tempValue.textContent = data.aiTemperature;
                        }
                        if (data.recordingQuality) document.getElementById('recordingQuality').value = data.recordingQuality;
                        if (data.frameRate) document.getElementById('frameRate').value = data.frameRate;
                        if (data.recordingFormat) document.getElementById('recordingFormat').value = data.recordingFormat;
                    });
            }
            
            function saveSettings() {
                const settings = {
                    autoStart: document.getElementById('autoStart').checked,
                    hotkeysEnabled: document.getElementById('hotkeysEnabled').checked,
                    aiSuggestions: document.getElementById('aiSuggestions').checked,
                    autoUpdate: document.getElementById('autoUpdate').checked,
                    aiModel: document.getElementById('aiModel').value,
                    ollamaHost: document.getElementById('ollamaHost').value,
                    aiTemperature: parseFloat(document.getElementById('aiTemperature').value),
                    useCloudAI: document.getElementById('useCloudAI').checked,
                    autoOrganize: document.getElementById('autoOrganize').checked,
                    keepBackups: document.getElementById('keepBackups').checked,
                    recordingQuality: document.getElementById('recordingQuality').value,
                    frameRate: document.getElementById('frameRate').value,
                    recordingFormat: document.getElementById('recordingFormat').value,
                    recordSystemAudio: document.getElementById('recordSystemAudio').checked,
                    recordMicrophone: document.getElementById('recordMicrophone').checked
                };
                
                fetch('/api/settings/save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settings)
                })
                .then(response => response.json())
                .then(data => {
                    alert('✅ Settings saved successfully!');
                    
                    // Show notification
                    showNotification('Settings updated', 'Your changes have been applied successfully.');
                });
            }
            
            function selectFolder(type) {
                // This would normally open a file dialog
                // For now, simulate with a prompt
                const folder = prompt(`Enter path for ${type} folder:`);
                if (folder) {
                    if (type === 'download') {
                        document.getElementById('downloadFolder').value = folder;
                    } else if (type === 'recordings') {
                        document.getElementById('recordingsFolder').value = folder;
                    }
                }
            }
            
            function configureHotkeys() {
                alert('Hotkey configuration would open here.
In the full version, you can press keys to assign them.');
            }
            
            function resetSettings() {
                if (confirm('Are you sure you want to reset all settings to defaults?')) {
                    fetch('/api/settings/reset', { method: 'POST' })
                        .then(response => response.json())
                        .then(data => {
                            alert('Settings reset to defaults!');
                            loadSettings();
                        });
                }
            }
            
            function clearData() {
                if (confirm('⚠️ DANGER: This will delete ALL your data including files, recordings, and automations. Continue?')) {
                    if (prompt('Type "DELETE ALL" to confirm:') === 'DELETE ALL') {
                        fetch('/api/settings/clear-data', { method: 'POST' })
                            .then(response => response.json())
                            .then(data => {
                                alert('All data has been cleared. The platform will restart.');
                                setTimeout(() => {
                                    window.location.href = '/';
                                }, 2000);
                            });
                    }
                }
            }
            
            function uninstall() {
                if (confirm('Are you sure you want to uninstall Agentic AI? This cannot be undone.')) {
                    if (prompt('Type "UNINSTALL" to confirm:') === 'UNINSTALL') {
                        alert('Uninstall process would start here.
In the actual application, this would remove all files and components.');
                    }
                }
            }
            
            function showNotification(title, message) {
                // Create notification element
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: rgba(16, 185, 129, 0.9);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 8px;
                    z-index: 1000;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                    animation: slideIn 0.3s ease;
                `;
                
                notification.innerHTML = `
                    <strong>${title}</strong>
                    <div style="margin-top: 5px; font-size: 0.9rem;">${message}</div>
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
                
                // Add CSS for animations
                if (!document.getElementById('notification-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-styles';
                    style.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes slideOut {
                            from { transform: translateX(0); opacity: 1; }
                            to { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
            
            // Load settings on page load
            window.onload = loadSettings;
            
            // Auto-save when toggle switches are changed
            document.querySelectorAll('.toggle-switch input').forEach(toggle => {
                toggle.addEventListener('change', saveSettings);
            });
            
            // Auto-save when select inputs are changed
            document.querySelectorAll('select').forEach(select => {
                select.addEventListener('change', saveSettings);
            });
        </script>
    </body>
</html>